# Cloudflare Pages Configuration
name = "fleetcore-website"
compatibility_date = "2025-10-16"
pages_build_output_dir = "dist"
compatibility_flags = ["nodejs_compat"]

# Ensure middleware runs for ALL requests (including 404s)
[observability]
enabled = true

# KV Namespace for Session Caching (short-term memory)
[[kv_namespaces]]
binding = "CHAT_SESSIONS"
id = "cb4530d9f96b49929d357a7d15c1864a"
preview_id = "01291c648a5a4669950780c9e180aa26"

# D1 Database for Persistent Memory (cross-session storage)
[[d1_databases]]
binding = "MARITIME_MEMORY"
database_name = "maritime-intelligence-memory"
database_id = "4db2707d-463b-4991-933e-a58a73a42aa9"
preview_database_id = "4db2707d-463b-4991-933e-a58a73a42aa9"

# Vectorize Index for Semantic Search
[[vectorize]]
binding = "VECTOR_INDEX"
index_name = "maritime-entities"
# Dimensions: 768 (matches @cf/baai/bge-base-en-v1.5 model)
# Run: wrangler vectorize create maritime-entities --dimensions=768 --metric=cosine

# Workers AI for embeddings & summarization
[ai]
binding = "AI"

# Note: For Cloudflare Pages, secrets are automatically bound to Functions
# when created via: npx wrangler pages secret put <KEY_NAME>
# No additional configuration needed in wrangler.toml
# Secrets are accessed via context.env.<KEY_NAME>
