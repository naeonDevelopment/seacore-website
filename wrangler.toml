# Cloudflare Pages Configuration
name = "fleetcore-website"
compatibility_date = "2025-10-16"
pages_build_output_dir = "dist"
compatibility_flags = ["nodejs_compat"]

# Ensure middleware runs for ALL requests (including 404s)
[observability]
enabled = true

# KV Namespace for Session Caching (short-term memory)
[[kv_namespaces]]
binding = "CHAT_SESSIONS"
id = "7e1ea6a8f95344f1b9819d4b0c4c33be"
preview_id = "3ec465ff79734cc8a833e16c6ea111f8"

# D1 Database for Persistent Memory (cross-session storage)
[[d1_databases]]
binding = "MARITIME_MEMORY"
database_name = "maritime-intelligence-memory"
database_id = "1f59ed38-d6cf-470e-bbd4-eea26528390c"
preview_database_id = "2c8b49de-1dc3-4885-a92b-e86ee51481d3"

# Vectorize Index for Semantic Search
[[vectorize]]
binding = "VECTOR_INDEX"
index_name = "maritime-entities"
# Dimensions: 768 (matches @cf/baai/bge-base-en-v1.5 model)
# Run: wrangler vectorize create maritime-entities --dimensions=768 --metric=cosine

# Workers AI for embeddings & summarization
[ai]
binding = "AI"

# Note: For Cloudflare Pages, secrets are automatically bound to Functions
# when created via: npx wrangler pages secret put <KEY_NAME>
# No additional configuration needed in wrangler.toml
# Secrets are accessed via context.env.<KEY_NAME>
